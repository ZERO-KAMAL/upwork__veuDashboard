{"remainingRequest":"C:\\Users\\Kamal\\Desktop\\upwork\\frontend_insurance\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Kamal\\Desktop\\upwork\\frontend_insurance\\src\\@fake-db\\jwt\\index.js","dependencies":[{"path":"C:\\Users\\Kamal\\Desktop\\upwork\\frontend_insurance\\src\\@fake-db\\jwt\\index.js","mtime":1653043180530},{"path":"C:\\Users\\Kamal\\Desktop\\upwork\\frontend_insurance\\babel.config.js","mtime":1653043180287},{"path":"C:\\Users\\Kamal\\Desktop\\upwork\\frontend_insurance\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1653043258756},{"path":"C:\\Users\\Kamal\\Desktop\\upwork\\frontend_insurance\\node_modules\\babel-loader\\lib\\index.js","mtime":1653043263838}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiQzpcXFVzZXJzXFxLYW1hbFxcRGVza3RvcFxcdXB3b3JrXFxmcm9udGVuZF9pbnN1cmFuY2VcXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lXFxoZWxwZXJzXFxlc21cXG9iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyI7CmltcG9ydCBtb2NrIGZyb20gJ0AvQGZha2UtZGIvbW9jayc7CmltcG9ydCBqd3QgZnJvbSAnanNvbndlYnRva2VuJzsKdmFyIGRhdGEgPSB7CiAgdXNlcnM6IFt7CiAgICBpZDogMSwKICAgIGZ1bGxOYW1lOiAnSm9obiBEb2UnLAogICAgdXNlcm5hbWU6ICdqb2huZG9lJywKICAgIHBhc3N3b3JkOiAnYWRtaW4nLAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGdsb2JhbC1yZXF1aXJlCiAgICBhdmF0YXI6IHJlcXVpcmUoJ0AvYXNzZXRzL2ltYWdlcy9hdmF0YXJzLzEzLXNtYWxsLnBuZycpLAogICAgZW1haWw6ICdhZG1pbkBkZW1vLmNvbScsCiAgICByb2xlOiAnYWRtaW4nLAogICAgYWJpbGl0eTogW3sKICAgICAgYWN0aW9uOiAnbWFuYWdlJywKICAgICAgc3ViamVjdDogJ2FsbCcKICAgIH1dLAogICAgZXh0cmFzOiB7CiAgICAgIGVDb21tZXJjZUNhcnRJdGVtc0NvdW50OiA1CiAgICB9CiAgfSwgewogICAgaWQ6IDIsCiAgICBmdWxsTmFtZTogJ0phbmUgRG9lJywKICAgIHVzZXJuYW1lOiAnamFuZWRvZScsCiAgICBwYXNzd29yZDogJ2NsaWVudCcsCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZ2xvYmFsLXJlcXVpcmUKICAgIGF2YXRhcjogcmVxdWlyZSgnQC9hc3NldHMvaW1hZ2VzL2F2YXRhcnMvMS1zbWFsbC5wbmcnKSwKICAgIGVtYWlsOiAnY2xpZW50QGRlbW8uY29tJywKICAgIHJvbGU6ICdjbGllbnQnLAogICAgYWJpbGl0eTogW3sKICAgICAgYWN0aW9uOiAncmVhZCcsCiAgICAgIHN1YmplY3Q6ICdBQ0wnCiAgICB9LCB7CiAgICAgIGFjdGlvbjogJ3JlYWQnLAogICAgICBzdWJqZWN0OiAnQXV0aCcKICAgIH1dLAogICAgZXh0cmFzOiB7CiAgICAgIGVDb21tZXJjZUNhcnRJdGVtc0NvdW50OiA1CiAgICB9CiAgfV0KfTsgLy8gISBUaGVzZSB0d28gc2VjcmV0cyBzaGFsbCBiZSBpbiAuZW52IGZpbGUgYW5kIG5vdCBpbiBhbnkgb3RoZXIgZmlsZQoKdmFyIGp3dENvbmZpZyA9IHsKICBzZWNyZXQ6ICdkZDVmMzA4OS00MGMzLTQwM2QtYWYxNC1kMGMyMjhiMDVjYjQnLAogIHJlZnJlc2hUb2tlblNlY3JldDogJzdjNGMxYzUwLTMyMzAtNDViZi05ZWFlLWM5YjJlNDAxYzc2NycsCiAgZXhwaXJlVGltZTogJzEwbScsCiAgcmVmcmVzaFRva2VuRXhwaXJlVGltZTogJzEwbScKfTsKbW9jay5vblBvc3QoJy9qd3QvbG9naW4nKS5yZXBseShmdW5jdGlvbiAocmVxdWVzdCkgewogIHZhciBfSlNPTiRwYXJzZSA9IEpTT04ucGFyc2UocmVxdWVzdC5kYXRhKSwKICAgICAgZW1haWwgPSBfSlNPTiRwYXJzZS5lbWFpbCwKICAgICAgcGFzc3dvcmQgPSBfSlNPTiRwYXJzZS5wYXNzd29yZDsKCiAgdmFyIGVycm9yID0gewogICAgZW1haWw6IFsnU29tZXRoaW5nIHdlbnQgd3JvbmcnXQogIH07CiAgdmFyIHVzZXIgPSBkYXRhLnVzZXJzLmZpbmQoZnVuY3Rpb24gKHUpIHsKICAgIHJldHVybiB1LmVtYWlsID09PSBlbWFpbCAmJiB1LnBhc3N3b3JkID09PSBwYXNzd29yZDsKICB9KTsKCiAgaWYgKHVzZXIpIHsKICAgIHRyeSB7CiAgICAgIHZhciBhY2Nlc3NUb2tlbiA9IGp3dC5zaWduKHsKICAgICAgICBpZDogdXNlci5pZAogICAgICB9LCBqd3RDb25maWcuc2VjcmV0LCB7CiAgICAgICAgZXhwaXJlc0luOiBqd3RDb25maWcuZXhwaXJlVGltZQogICAgICB9KTsKICAgICAgdmFyIHJlZnJlc2hUb2tlbiA9IGp3dC5zaWduKHsKICAgICAgICBpZDogdXNlci5pZAogICAgICB9LCBqd3RDb25maWcucmVmcmVzaFRva2VuU2VjcmV0LCB7CiAgICAgICAgZXhwaXJlc0luOiBqd3RDb25maWcucmVmcmVzaFRva2VuRXhwaXJlVGltZQogICAgICB9KTsKCiAgICAgIHZhciB1c2VyRGF0YSA9IF9vYmplY3RTcHJlYWQoe30sIHVzZXIpOwoKICAgICAgZGVsZXRlIHVzZXJEYXRhLnBhc3N3b3JkOwogICAgICB2YXIgcmVzcG9uc2UgPSB7CiAgICAgICAgdXNlckRhdGE6IHVzZXJEYXRhLAogICAgICAgIGFjY2Vzc1Rva2VuOiBhY2Nlc3NUb2tlbiwKICAgICAgICByZWZyZXNoVG9rZW46IHJlZnJlc2hUb2tlbgogICAgICB9OwogICAgICByZXR1cm4gWzIwMCwgcmVzcG9uc2VdOwogICAgfSBjYXRjaCAoZSkgewogICAgICBlcnJvciA9IGU7CiAgICB9CiAgfSBlbHNlIHsKICAgIGVycm9yID0gewogICAgICBlbWFpbDogWydFbWFpbCBvciBQYXNzd29yZCBpcyBJbnZhbGlkJ10KICAgIH07CiAgfQoKICByZXR1cm4gWzQwMCwgewogICAgZXJyb3I6IGVycm9yCiAgfV07Cn0pOwptb2NrLm9uUG9zdCgnL2p3dC9yZWdpc3RlcicpLnJlcGx5KGZ1bmN0aW9uIChyZXF1ZXN0KSB7CiAgdmFyIF9KU09OJHBhcnNlMiA9IEpTT04ucGFyc2UocmVxdWVzdC5kYXRhKSwKICAgICAgdXNlcm5hbWUgPSBfSlNPTiRwYXJzZTIudXNlcm5hbWUsCiAgICAgIGVtYWlsID0gX0pTT04kcGFyc2UyLmVtYWlsLAogICAgICBwYXNzd29yZCA9IF9KU09OJHBhcnNlMi5wYXNzd29yZDsgLy8gSWYgbm90IGFueSBvZiBkYXRhIGlzIG1pc3NpbmcgcmV0dXJuIDQwMAoKCiAgaWYgKCEodXNlcm5hbWUgJiYgZW1haWwgJiYgcGFzc3dvcmQpKSByZXR1cm4gWzQwMF07CiAgdmFyIGlzRW1haWxBbHJlYWR5SW5Vc2UgPSBkYXRhLnVzZXJzLmZpbmQoZnVuY3Rpb24gKHVzZXIpIHsKICAgIHJldHVybiB1c2VyLmVtYWlsID09PSBlbWFpbDsKICB9KTsKICB2YXIgaXNVc2VybmFtZUFscmVhZHlJblVzZSA9IGRhdGEudXNlcnMuZmluZChmdW5jdGlvbiAodXNlcikgewogICAgcmV0dXJuIHVzZXIudXNlcm5hbWUgPT09IHVzZXJuYW1lOwogIH0pOwogIHZhciBlcnJvciA9IHsKICAgIHBhc3N3b3JkOiAhcGFzc3dvcmQgPyBbJ1BsZWFzZSBlbnRlciBwYXNzd29yZCddIDogbnVsbCwKICAgIGVtYWlsOiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICghZW1haWwpIHJldHVybiBbJ1BsZWFzZSBlbnRlciB5b3VyIGVtYWlsLiddOwogICAgICBpZiAoaXNFbWFpbEFscmVhZHlJblVzZSkgcmV0dXJuIFsnVGhpcyBlbWFpbCBpcyBhbHJlYWR5IGluIHVzZS4nXTsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9KCksCiAgICB1c2VybmFtZTogZnVuY3Rpb24gKCkgewogICAgICBpZiAoIXVzZXJuYW1lKSByZXR1cm4gWydQbGVhc2UgZW50ZXIgeW91ciB1c2VybmFtZS4nXTsKICAgICAgaWYgKGlzVXNlcm5hbWVBbHJlYWR5SW5Vc2UpIHJldHVybiBbJ1RoaXMgdXNlcm5hbWUgaXMgYWxyZWFkeSBpbiB1c2UuJ107CiAgICAgIHJldHVybiBudWxsOwogICAgfSgpCiAgfTsKCiAgaWYgKCFlcnJvci51c2VybmFtZSAmJiAhZXJyb3IuZW1haWwpIHsKICAgIHZhciB1c2VyRGF0YSA9IHsKICAgICAgZW1haWw6IGVtYWlsLAogICAgICBwYXNzd29yZDogcGFzc3dvcmQsCiAgICAgIHVzZXJuYW1lOiB1c2VybmFtZSwKICAgICAgZnVsbE5hbWU6ICcnLAogICAgICBhdmF0YXI6IG51bGwsCiAgICAgIHJvbGU6ICdhZG1pbicsCiAgICAgIGFiaWxpdHk6IFt7CiAgICAgICAgYWN0aW9uOiAnbWFuYWdlJywKICAgICAgICBzdWJqZWN0OiAnYWxsJwogICAgICB9XQogICAgfTsgLy8gQWRkIHVzZXIgaWQKCiAgICB2YXIgbGVuZ3RoID0gZGF0YS51c2Vycy5sZW5ndGg7CiAgICB2YXIgbGFzdEluZGV4ID0gMDsKCiAgICBpZiAobGVuZ3RoKSB7CiAgICAgIGxhc3RJbmRleCA9IGRhdGEudXNlcnNbbGVuZ3RoIC0gMV0uaWQ7CiAgICB9CgogICAgdXNlckRhdGEuaWQgPSBsYXN0SW5kZXggKyAxOwogICAgZGF0YS51c2Vycy5wdXNoKHVzZXJEYXRhKTsKICAgIHZhciBhY2Nlc3NUb2tlbiA9IGp3dC5zaWduKHsKICAgICAgaWQ6IHVzZXJEYXRhLmlkCiAgICB9LCBqd3RDb25maWcuc2VjcmV0LCB7CiAgICAgIGV4cGlyZXNJbjogand0Q29uZmlnLmV4cGlyZVRpbWUKICAgIH0pOwoKICAgIHZhciB1c2VyID0gX29iamVjdFNwcmVhZCh7fSwgdXNlckRhdGEpOwoKICAgIGRlbGV0ZSB1c2VyLnBhc3N3b3JkOwogICAgdmFyIHJlc3BvbnNlID0gewogICAgICB1c2VyRGF0YTogdXNlciwKICAgICAgYWNjZXNzVG9rZW46IGFjY2Vzc1Rva2VuCiAgICB9OwogICAgcmV0dXJuIFsyMDAsIHJlc3BvbnNlXTsKICB9CgogIHJldHVybiBbNDAwLCB7CiAgICBlcnJvcjogZXJyb3IKICB9XTsKfSk7Cm1vY2sub25Qb3N0KCcvand0L3JlZnJlc2gtdG9rZW4nKS5yZXBseShmdW5jdGlvbiAocmVxdWVzdCkgewogIHZhciBfSlNPTiRwYXJzZTMgPSBKU09OLnBhcnNlKHJlcXVlc3QuZGF0YSksCiAgICAgIHJlZnJlc2hUb2tlbiA9IF9KU09OJHBhcnNlMy5yZWZyZXNoVG9rZW47CgogIHRyeSB7CiAgICB2YXIgX2p3dCR2ZXJpZnkgPSBqd3QudmVyaWZ5KHJlZnJlc2hUb2tlbiwgand0Q29uZmlnLnJlZnJlc2hUb2tlblNlY3JldCksCiAgICAgICAgaWQgPSBfand0JHZlcmlmeS5pZDsKCiAgICB2YXIgdXNlckRhdGEgPSBfb2JqZWN0U3ByZWFkKHt9LCBkYXRhLnVzZXJzLmZpbmQoZnVuY3Rpb24gKHVzZXIpIHsKICAgICAgcmV0dXJuIHVzZXIuaWQgPT09IGlkOwogICAgfSkpOwoKICAgIHZhciBuZXdBY2Nlc3NUb2tlbiA9IGp3dC5zaWduKHsKICAgICAgaWQ6IHVzZXJEYXRhLmlkCiAgICB9LCBqd3RDb25maWcuc2VjcmV0LCB7CiAgICAgIGV4cGlyZXNJbjogand0Q29uZmlnLmV4cGlyZXNJbgogICAgfSk7CiAgICB2YXIgbmV3UmVmcmVzaFRva2VuID0gand0LnNpZ24oewogICAgICBpZDogdXNlckRhdGEuaWQKICAgIH0sIGp3dENvbmZpZy5yZWZyZXNoVG9rZW5TZWNyZXQsIHsKICAgICAgZXhwaXJlc0luOiBqd3RDb25maWcucmVmcmVzaFRva2VuRXhwaXJlVGltZQogICAgfSk7CiAgICBkZWxldGUgdXNlckRhdGEucGFzc3dvcmQ7CiAgICB2YXIgcmVzcG9uc2UgPSB7CiAgICAgIHVzZXJEYXRhOiB1c2VyRGF0YSwKICAgICAgYWNjZXNzVG9rZW46IG5ld0FjY2Vzc1Rva2VuLAogICAgICByZWZyZXNoVG9rZW46IG5ld1JlZnJlc2hUb2tlbgogICAgfTsKICAgIHJldHVybiBbMjAwLCByZXNwb25zZV07CiAgfSBjYXRjaCAoZSkgewogICAgdmFyIGVycm9yID0gJ0ludmFsaWQgcmVmcmVzaCB0b2tlbic7CiAgICByZXR1cm4gWzQwMSwgewogICAgICBlcnJvcjogZXJyb3IKICAgIH1dOwogIH0KfSk7"},{"version":3,"sources":["C:/Users/Kamal/Desktop/upwork/frontend_insurance/src/@fake-db/jwt/index.js"],"names":["mock","jwt","data","users","id","fullName","username","password","avatar","require","email","role","ability","action","subject","extras","eCommerceCartItemsCount","jwtConfig","secret","refreshTokenSecret","expireTime","refreshTokenExpireTime","onPost","reply","request","JSON","parse","error","user","find","u","accessToken","sign","expiresIn","refreshToken","userData","response","e","isEmailAlreadyInUse","isUsernameAlreadyInUse","length","lastIndex","push","verify","newAccessToken","newRefreshToken"],"mappings":"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","sourcesContent":["import mock from '@/@fake-db/mock'\r\nimport jwt from 'jsonwebtoken'\r\n\r\nconst data = {\r\n  users: [\r\n    {\r\n      id: 1,\r\n      fullName: 'John Doe',\r\n      username: 'johndoe',\r\n      password: 'admin',\r\n      // eslint-disable-next-line global-require\r\n      avatar: require('@/assets/images/avatars/13-small.png'),\r\n      email: 'admin@demo.com',\r\n      role: 'admin',\r\n      ability: [\r\n        {\r\n          action: 'manage',\r\n          subject: 'all',\r\n        },\r\n      ],\r\n      extras: {\r\n        eCommerceCartItemsCount: 5,\r\n      },\r\n    },\r\n    {\r\n      id: 2,\r\n      fullName: 'Jane Doe',\r\n      username: 'janedoe',\r\n      password: 'client',\r\n      // eslint-disable-next-line global-require\r\n      avatar: require('@/assets/images/avatars/1-small.png'),\r\n      email: 'client@demo.com',\r\n      role: 'client',\r\n      ability: [\r\n        {\r\n          action: 'read',\r\n          subject: 'ACL',\r\n        },\r\n        {\r\n          action: 'read',\r\n          subject: 'Auth',\r\n        },\r\n      ],\r\n      extras: {\r\n        eCommerceCartItemsCount: 5,\r\n      },\r\n    },\r\n  ],\r\n}\r\n\r\n// ! These two secrets shall be in .env file and not in any other file\r\nconst jwtConfig = {\r\n  secret: 'dd5f3089-40c3-403d-af14-d0c228b05cb4',\r\n  refreshTokenSecret: '7c4c1c50-3230-45bf-9eae-c9b2e401c767',\r\n  expireTime: '10m',\r\n  refreshTokenExpireTime: '10m',\r\n}\r\n\r\nmock.onPost('/jwt/login').reply(request => {\r\n  const { email, password } = JSON.parse(request.data)\r\n\r\n  let error = {\r\n    email: ['Something went wrong'],\r\n  }\r\n\r\n  const user = data.users.find(u => u.email === email && u.password === password)\r\n\r\n  if (user) {\r\n    try {\r\n      const accessToken = jwt.sign({ id: user.id }, jwtConfig.secret, { expiresIn: jwtConfig.expireTime })\r\n      const refreshToken = jwt.sign({ id: user.id }, jwtConfig.refreshTokenSecret, {\r\n        expiresIn: jwtConfig.refreshTokenExpireTime,\r\n      })\r\n\r\n      const userData = { ...user }\r\n\r\n      delete userData.password\r\n\r\n      const response = {\r\n        userData,\r\n        accessToken,\r\n        refreshToken,\r\n      }\r\n\r\n      return [200, response]\r\n    } catch (e) {\r\n      error = e\r\n    }\r\n  } else {\r\n    error = {\r\n      email: ['Email or Password is Invalid'],\r\n    }\r\n  }\r\n\r\n  return [400, { error }]\r\n})\r\n\r\nmock.onPost('/jwt/register').reply(request => {\r\n  const { username, email, password } = JSON.parse(request.data)\r\n\r\n  // If not any of data is missing return 400\r\n  if (!(username && email && password)) return [400]\r\n\r\n  const isEmailAlreadyInUse = data.users.find(user => user.email === email)\r\n  const isUsernameAlreadyInUse = data.users.find(user => user.username === username)\r\n\r\n  const error = {\r\n    password: !password ? ['Please enter password'] : null,\r\n    email: (() => {\r\n      if (!email) return ['Please enter your email.']\r\n      if (isEmailAlreadyInUse) return ['This email is already in use.']\r\n      return null\r\n    })(),\r\n    username: (() => {\r\n      if (!username) return ['Please enter your username.']\r\n      if (isUsernameAlreadyInUse) return ['This username is already in use.']\r\n      return null\r\n    })(),\r\n  }\r\n\r\n  if (!error.username && !error.email) {\r\n    const userData = {\r\n      email,\r\n      password,\r\n      username,\r\n      fullName: '',\r\n      avatar: null,\r\n      role: 'admin',\r\n      ability: [\r\n        {\r\n          action: 'manage',\r\n          subject: 'all',\r\n        },\r\n      ],\r\n    }\r\n\r\n    // Add user id\r\n    const { length } = data.users\r\n    let lastIndex = 0\r\n    if (length) {\r\n      lastIndex = data.users[length - 1].id\r\n    }\r\n    userData.id = lastIndex + 1\r\n\r\n    data.users.push(userData)\r\n\r\n    const accessToken = jwt.sign({ id: userData.id }, jwtConfig.secret, { expiresIn: jwtConfig.expireTime })\r\n\r\n    const user = { ...userData }\r\n    delete user.password\r\n    const response = {\r\n      userData: user,\r\n      accessToken,\r\n    }\r\n\r\n    return [200, response]\r\n  }\r\n  return [400, { error }]\r\n})\r\n\r\nmock.onPost('/jwt/refresh-token').reply(request => {\r\n  const { refreshToken } = JSON.parse(request.data)\r\n\r\n  try {\r\n    const { id } = jwt.verify(refreshToken, jwtConfig.refreshTokenSecret)\r\n\r\n    const userData = { ...data.users.find(user => user.id === id) }\r\n\r\n    const newAccessToken = jwt.sign({ id: userData.id }, jwtConfig.secret, { expiresIn: jwtConfig.expiresIn })\r\n    const newRefreshToken = jwt.sign({ id: userData.id }, jwtConfig.refreshTokenSecret, {\r\n      expiresIn: jwtConfig.refreshTokenExpireTime,\r\n    })\r\n\r\n    delete userData.password\r\n    const response = {\r\n      userData,\r\n      accessToken: newAccessToken,\r\n      refreshToken: newRefreshToken,\r\n    }\r\n\r\n    return [200, response]\r\n  } catch (e) {\r\n    const error = 'Invalid refresh token'\r\n    return [401, { error }]\r\n  }\r\n})\r\n"]}]}